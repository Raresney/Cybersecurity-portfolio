
#Simple Website Security Check Tool using python.

Copyright (c) 2026 Bighiu Rares - https://github.com/Raresney

import argparse
import requests
import json
import os
import logging
from urllib.parse import urlparse

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

def has_https(url):
    parsed_url = urlparse(url)
    if parsed_url.scheme != "https":
        return False, "⚠️ HTTPS not enabled! This is a security risk."
    return True, "✅ HTTPS is active."

def get_headers(url):
    try:
        response = requests.get(url, timeout=5)
        return response.headers
    except requests.exceptions.Timeout:
        logging.warning("Timeout while fetching headers for %s", url)
        return None
    except requests.exceptions.RequestException as e:
        logging.error("Error fetching headers: %s", e)
        return None

def missing_headers(headers):
    required = ["X-Frame-Options", "Content-Security-Policy", "Strict-Transport-Security",
                "Referrer-Policy", "Permissions-Policy"]
    if not headers:
        return "Could not fetch headers."
    missing = [h for h in required if h not in headers]
    return ", ".join(missing) if missing else "All important headers present."

def detect_waf(url):
    try:
        response = requests.get(url, timeout=5, headers={"User-Agent": "Mozilla/5.0"})
        waf_indicators = ["Server", "X-Sucuri-ID", "CF-RAY", "X-CDN", "X-Powered-By"]
        detected = [f"{h}: {response.headers[h]}" for h in waf_indicators if h in response.headers]
        if response.status_code == 403:
            detected.append("Potential WAF: Received HTTP 403.")
        return ", ".join(detected) if detected else "No WAF detected."
    except requests.exceptions.RequestException:
        return "Error fetching page for WAF detection."

def detect_cms(url):
    try:
        response = requests.get(url, timeout=5)
        cms_markers = {
            "WordPress": ["wp-content", "wp-includes"],
            "Joomla": ["Joomla"],
            "Drupal": ["drupal.js"],
            "Magento": ["Mage.Cookies"]
        }
        for cms, markers in cms_markers.items():
            if any(marker in response.text for marker in markers):
                return cms
        return "No CMS detected."
    except requests.exceptions.RequestException:
        return "CMS detection failed."

def check_directory_listing(url):
    try:
        response = requests.get(url + "/", timeout=5)
        return "⚠️ Directory listing is enabled!" if "Index of /" in response.text else "Directory listing not found."
    except requests.exceptions.RequestException:
        return "No response from server."

def save_results(results, url, fmt, filename):
    try:
        if fmt == "json":
            with open(filename, "w") as f:
                json.dump(results, f, indent=4)
        elif fmt == "html":
            with open(filename, "w") as f:
                f.write(f"""
                <html>
                <head>
                    <title>Website Security Report</title>
                    <style>
                        body {{ font-family: Arial; padding: 20px; }}
                        table {{ border-collapse: collapse; width: 100%; }}
                        th, td {{ border: 1px solid #ddd; padding: 8px; }}
                        th {{ background-color: #4CAF50; color: white; }}
                        tr:nth-child(even) {{ background-color: #f2f2f2; }}
                        tr:hover {{ background-color: #ddd; }}
                        a.button {{ 
                            text-decoration: none; 
                            background-color: #4CAF50; 
                            color: white; 
                            padding: 5px 10px; 
                            border-radius: 5px;
                        }}
                    </style>
                </head>
                <body>
                    <h1>Website Security Report</h1>
                    <p>Scanned URL: <a href="{url}" target="_blank">{url}</a></p>
                    <table>
                        <tr><th>Check</th><th>Result</th></tr>
                """)
                for key, value in results.items():
                    if key == "WAF Detection" or key == "CMS Detection":
                        # make clickable links if possible
                        f.write(f"<tr><td>{key}</td><td>{value}</td></tr>")
                    else:
                        f.write(f"<tr><td>{key}</td><td>{value}</td></tr>")
                f.write("</table></body></html>")

        if os.path.exists(filename):
            logging.info("✅ Report saved as: %s", filename)
        else:
            logging.warning("❌ Failed to save report.")
    except IOError:
        logging.error("Cannot write file: %s", filename)

def main():
    parser = argparse.ArgumentParser(description="Interactive website security scanner.")
    parser.add_argument("url", help="URL of the website to scan.")
    parser.add_argument("--output", help="Save results as JSON or HTML.", choices=["json", "html"], default=None)
    args = parser.parse_args()

    url = args.url if args.url.startswith("http") else "https://" + args.url
    domain_safe = urlparse(url).netloc.replace(".", "_")
    logging.info("Scanning: %s", url)
    
    results = {
        "HTTPS": has_https(url)[1],
        "Missing Security Headers": missing_headers(get_headers(url)),
        "WAF Detection": detect_waf(url),
        "CMS Detection": detect_cms(url),
        "Directory Listing": check_directory_listing(url)
    }
    
    for key, value in results.items():
        print(f"{key}: {value}")
    
    if args.output:
        filename = f"security_report_{domain_safe}.{args.output}"
        save_results(results, url, args.output, filename)

if __name__ == "__main__":
    main()
